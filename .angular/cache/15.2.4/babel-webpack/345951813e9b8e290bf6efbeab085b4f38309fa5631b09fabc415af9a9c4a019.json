{"ast":null,"code":"// import { HttpClient, HttpErrorResponse } from \"@angular/common/http\";\n// import { Injectable } from \"@angular/core\";\n// import { catchError, tap } from \"rxjs/operators\";\n// import { BehaviorSubject, throwError } from \"rxjs\";\n// import { User } from \"./user.model\";\n// import { Route, Router } from \"@angular/router\";\n// export interface AuthResponseData {\n//     kind: string;\n//     idToken: string;\n//     email: string;\n//     refreshToken: string;\n//     expiresIn: string;\n//     localId: string;\n//     registered?: boolean;\n// }\n// @Injectable({ \n//     providedIn: 'root' \n// })\n// export class AuthService{\n//     user = new BehaviorSubject<User>(null);\n//     token: string = null;\n//     private tokenExpirationTime: any;\n//     constructor(private http: HttpClient, private router: Router){\n//     }\n//     signup(email: string, password: string ){\n//         return this.http.post<AuthResponseData>(\n//             'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDzLGQj2UYQCx66VgeEe3PkRfacUhrbRmA',\n//         {\n//             email: email,\n//             password: password,\n//             returnSecuredToken: true\n//         }).pipe(catchError(this.handlError), \n//             tap(resData => {\n//             this.handleAuthentication(\n//                 resData.email, \n//                 resData.localId, \n//                 resData.idToken, \n//                 +resData.expiresIn\n//             )\n//         }));\n//     }\n//     login(email: string, password: string){\n//         return this.http.post<AuthResponseData>(\n//             'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDzLGQj2UYQCx66VgeEe3PkRfacUhrbRmA',\n//             {\n//                 email: email,\n//                 password: password,\n//                 returnSecuredToken: true\n//             }).pipe(catchError(this.handlError), tap(resData => {            \n//                 this.handleAuthentication(resData.email, resData.localId, resData.idToken, +resData.expiresIn)\n//             }));\n//     }\n//     autoLogin(){\n//         const userData: {\n//             email : string;\n//             id: string;\n//             _token : string;\n//             _tokenExpirationDate : string;\n//         } = JSON.parse(localStorage.getItem('userData'));\n//         if(!userData){\n//             return;\n//         }\n//         const loadedUser = new User(\n//             userData.email, \n//             userData.id, \n//             userData._token,\n//             new Date(userData._tokenExpirationDate)\n//         );\n//         if(loadedUser.token){\n//             this.user.next(loadedUser);\n//             const expirationDate = new Date(userData._tokenExpirationDate).getTime() - new Date().getTime();\n//             this.autoLogout(expirationDate);\n//             console.log(expirationDate);\n//         }\n//     }\n//     logout(){\n//         this.user.next(null);\n//         this.router.navigate(['./auth']);\n//         localStorage.removeItem('userData');\n//         if(this.tokenExpirationTime){\n//             clearTimeout(this.tokenExpirationTime);\n//         }\n//         this.tokenExpirationTime = null;\n//     }\n//     autoLogout(expirationDuration: number){\n//         console.log(expirationDuration);\n//         setTimeout(()=>{   \n//             this.logout();\n//         }, 7000000);\n//     }\n//     private handleAuthentication(email: string,userId: string, token: string, expiresIn: number){\n//         const expirationDate = new Date(new Date().getTime()+ (expiresIn*1000));\n//         const user = new User(email, userId, token, expirationDate)\n//         this.user.next(user);\n//         this.autoLogout(expiresIn * 1000);\n//         localStorage.setItem('userData', JSON.stringify(user))\n//     }\n//     private handlError(errorRes: HttpErrorResponse){\n//         let errorMsg = \"An Unknown error has been occured\"\n//         console.log(errorRes.error.error);\n//         // errorRes.error && errorRes.error.error\n//         if(!errorRes.error || !errorRes.error.error){\n//             return throwError(errorMsg);\n//         }\n//         switch( errorRes.error.error.message){\n//             case 'EMAIL_EXISTS': errorMsg = \"An Email Exists Already\";\n//                                 break;\n//             case 'EMAIL_NOT_FOUND': errorMsg = \"This Email does not Exist\";\n//             break;\n//             case 'INVALID_PASSWORD': errorMsg = \"Password is Incorrect\";\n//             break;\n//         }\n//         return throwError(errorMsg);       \n//     }\n// }","map":{"version":3,"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA","names":[],"sourceRoot":"","sources":["E:\\DOCUMENTS\\Internship\\Angular\\Project\\src\\app\\auth\\auth.service.ts"],"sourcesContent":["// import { HttpClient, HttpErrorResponse } from \"@angular/common/http\";\r\n// import { Injectable } from \"@angular/core\";\r\n// import { catchError, tap } from \"rxjs/operators\";\r\n// import { BehaviorSubject, throwError } from \"rxjs\";\r\n// import { User } from \"./user.model\";\r\n// import { Route, Router } from \"@angular/router\";\r\n\r\n// export interface AuthResponseData {\r\n//     kind: string;\r\n//     idToken: string;\r\n//     email: string;\r\n//     refreshToken: string;\r\n//     expiresIn: string;\r\n//     localId: string;\r\n//     registered?: boolean;\r\n// }\r\n\r\n\r\n// @Injectable({ \r\n//     providedIn: 'root' \r\n// })\r\n// export class AuthService{\r\n\r\n//     user = new BehaviorSubject<User>(null);\r\n//     token: string = null;\r\n//     private tokenExpirationTime: any;\r\n    \r\n//     constructor(private http: HttpClient, private router: Router){\r\n//     }\r\n\r\n\r\n//     signup(email: string, password: string ){\r\n//         return this.http.post<AuthResponseData>(\r\n//             'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDzLGQj2UYQCx66VgeEe3PkRfacUhrbRmA',\r\n//         {\r\n//             email: email,\r\n//             password: password,\r\n//             returnSecuredToken: true\r\n\r\n//         }).pipe(catchError(this.handlError), \r\n//             tap(resData => {\r\n//             this.handleAuthentication(\r\n//                 resData.email, \r\n//                 resData.localId, \r\n//                 resData.idToken, \r\n//                 +resData.expiresIn\r\n//             )\r\n//         }));\r\n//     }\r\n\r\n//     login(email: string, password: string){\r\n//         return this.http.post<AuthResponseData>(\r\n//             'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDzLGQj2UYQCx66VgeEe3PkRfacUhrbRmA',\r\n//             {\r\n//                 email: email,\r\n//                 password: password,\r\n//                 returnSecuredToken: true\r\n//             }).pipe(catchError(this.handlError), tap(resData => {            \r\n//                 this.handleAuthentication(resData.email, resData.localId, resData.idToken, +resData.expiresIn)\r\n//             }));\r\n//     }\r\n\r\n//     autoLogin(){\r\n//         const userData: {\r\n//             email : string;\r\n//             id: string;\r\n//             _token : string;\r\n//             _tokenExpirationDate : string;\r\n//         } = JSON.parse(localStorage.getItem('userData'));\r\n//         if(!userData){\r\n//             return;\r\n//         }\r\n\r\n//         const loadedUser = new User(\r\n//             userData.email, \r\n//             userData.id, \r\n//             userData._token,\r\n//             new Date(userData._tokenExpirationDate)\r\n//         );\r\n    \r\n//         if(loadedUser.token){\r\n//             this.user.next(loadedUser);\r\n//             const expirationDate = new Date(userData._tokenExpirationDate).getTime() - new Date().getTime();\r\n//             this.autoLogout(expirationDate);\r\n//             console.log(expirationDate);\r\n//         }\r\n//     }\r\n\r\n//     logout(){\r\n//         this.user.next(null);\r\n//         this.router.navigate(['./auth']);\r\n//         localStorage.removeItem('userData');\r\n//         if(this.tokenExpirationTime){\r\n//             clearTimeout(this.tokenExpirationTime);\r\n//         }\r\n//         this.tokenExpirationTime = null;\r\n//     }\r\n\r\n//     autoLogout(expirationDuration: number){\r\n//         console.log(expirationDuration);\r\n      \r\n//         setTimeout(()=>{   \r\n//             this.logout();\r\n//         }, 7000000);\r\n//     }\r\n\r\n//     private handleAuthentication(email: string,userId: string, token: string, expiresIn: number){\r\n//         const expirationDate = new Date(new Date().getTime()+ (expiresIn*1000));\r\n//         const user = new User(email, userId, token, expirationDate)\r\n//         this.user.next(user);\r\n//         this.autoLogout(expiresIn * 1000);\r\n//         localStorage.setItem('userData', JSON.stringify(user))\r\n    \r\n//     }\r\n\r\n//     private handlError(errorRes: HttpErrorResponse){\r\n        \r\n//         let errorMsg = \"An Unknown error has been occured\"\r\n//         console.log(errorRes.error.error);\r\n        \r\n//         // errorRes.error && errorRes.error.error\r\n//         if(!errorRes.error || !errorRes.error.error){\r\n//             return throwError(errorMsg);\r\n//         }\r\n        \r\n//         switch( errorRes.error.error.message){\r\n//             case 'EMAIL_EXISTS': errorMsg = \"An Email Exists Already\";\r\n//                                 break;\r\n//             case 'EMAIL_NOT_FOUND': errorMsg = \"This Email does not Exist\";\r\n//             break;\r\n//             case 'INVALID_PASSWORD': errorMsg = \"Password is Incorrect\";\r\n//             break;\r\n        \r\n//         }\r\n//         return throwError(errorMsg);       \r\n//     }\r\n// }\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}